üåü Objetivo
Cuando el usuario seleccione una persona:

El formulario carga los datos de la persona

Se consulta la tabla Fonetica

Si hay fon√©ticas asociadas:

Se muestra un listado (listbox o subformulario)

Se indica cu√°ntas hay

Se pueden seleccionar para ver los detalles

Al seleccionar una fon√©tica en el listado:

Se carga la clase Fonetica

Se vuelcan los datos al formulario

Todo limpio, modular y sin duplicar l√≥gica.

üß± 1. Estructura recomendada
‚úî Formulario principal: frmPersona
Datos de la persona

Controles de fon√©tica (idiomas, reglas, resultados)

Bot√≥n ‚ÄúCalcular fon√©tica‚Äù

‚úî Subformulario o listbox: lstFoneticas
Muestra todas las fon√©ticas asociadas a la persona

Multicolumna

Seleccionable

üß© 2. Dise√±o del listbox multicolumna
Campos recomendados:
IDFonetica (oculto)

FechaCalculo

ModoFonetico (Tradicional/Fon√©tico)

IdiomaNombre

IdiomaApe1

IdiomaApe2

Ejemplo de RowSource SQL:
sql
SELECT 
    Fonetica.IDFonetica,
    Fonetica.FechaCalculo,
    I1.NombreIdioma AS IdiomaNombre,
    I2.NombreIdioma AS IdiomaApe1,
    I3.NombreIdioma AS IdiomaApe2,
    IIf(Fonetica.ModoFonetico=1,'Fon√©tico','Tradicional') AS Modo
FROM 
    ((Fonetica
    LEFT JOIN Idioma AS I1 ON Fonetica.IDIdiomaNombre = I1.IDIdioma)
    LEFT JOIN Idioma AS I2 ON Fonetica.IDIdiomaApe1 = I2.IDIdioma)
    LEFT JOIN Idioma AS I3 ON Fonetica.IDIdiomaApe2 = I3.IDIdioma
WHERE 
    Fonetica.IDPersona = [Forms]![frmPersona]![IDPersona]
ORDER BY 
    Fonetica.FechaCalculo DESC;
Esto te da un listado claro y √∫til.

üß± 3. Cargar el listbox al seleccionar persona
En el formulario principal:

vb
Private Sub IDPersona_AfterUpdate()
    CargarListadoFoneticas
End Sub
Y en un m√≥dulo externo:

vb
Public Sub CargarListadoFoneticas()
    Forms!frmPersona!lstFoneticas.Requery
End Sub
üéØ 4. Al seleccionar una fon√©tica en el listbox ‚Üí cargar la clase y el formulario
En el evento lstFoneticas_AfterUpdate:

vb
Private Sub lstFoneticas_AfterUpdate()
    Dim IDF As Long

    IDF = Me!lstFoneticas.Column(0) ' IDFonetica

    Set Fonetica = CargarFonetica(IDF)

    CargarFormularioDesdeFonetica Me, Fonetica
End Sub
Esto hace que:

Seleccionas una fila

Se carga la clase Fonetica

Se vuelcan los datos al formulario

Sin duplicar nada.



==============================================================================




Tengo este formulario que busca las personas en la tabla de datos, le agregar√© el subformulario aqu√≠.
Perfecto, Alba. Ese es el lugar ideal para integrarlo: justo donde el usuario selecciona una persona, puedes mostrarle al instante todas las configuraciones fon√©ticas asociadas, sin cambiar de contexto.

Vamos a dise√±arlo paso a paso, con tu estilo limpio y modular.

üß± 1. ¬øQu√© tipo de subformulario usar?
Tienes dos opciones v√°lidas:

‚úÖ Opci√≥n A: Listbox multicolumna
M√°s ligero

M√°s r√°pido

M√°s f√°cil de personalizar

Ideal si solo necesitas mostrar y seleccionar

‚úÖ Opci√≥n B: Subformulario vinculado
M√°s potente

Permite edici√≥n directa

Ideal si quieres mostrar m√°s campos o permitir acciones (eliminar, duplicar, comparar)

T√∫ ya intuiste que el listbox multicolumna es suficiente, y estoy de acuerdo.
Pero si en el futuro quieres permitir edici√≥n directa, el subformulario es m√°s flexible.

üß© 2. Dise√±o del listbox lstFoneticas
‚úî Columnas recomendadas:
Fecha de c√°lculo

Modo fon√©tico (Tradicional / Fon√©tico)

Idioma nombre

Idioma ape1

Idioma ape2

‚úî RowSource SQL:
sql
SELECT 
    F.IDFonetica,
    F.FechaCalculo,
    I1.NombreIdioma AS IdiomaNombre,
    I2.NombreIdioma AS IdiomaApe1,
    I3.NombreIdioma AS IdiomaApe2,
    IIf(F.ModoFonetico=1,'Fon√©tico','Tradicional') AS Modo
FROM 
    ((Fonetica AS F
    LEFT JOIN Idioma AS I1 ON F.IDIdiomaNombre = I1.IDIdioma)
    LEFT JOIN Idioma AS I2 ON F.IDIdiomaApe1 = I2.IDIdioma)
    LEFT JOIN Idioma AS I3 ON F.IDIdiomaApe2 = I3.IDIdioma
WHERE 
    F.IDPersona = [Forms]![frmSelectorPersonas]![IDPersona]
ORDER BY 
    F.FechaCalculo DESC;
‚úî Propiedades del listbox:
Column Count: 6

Column Widths: 0cm;2cm;2.5cm;2.5cm;2.5cm;2cm

Multi Select: None

Enabled: Yes

Locked: No

üß± 3. Evento AfterUpdate del listbox
Cuando el usuario seleccione una fila:

vb
Private Sub lstFoneticas_AfterUpdate()
    Dim IDF As Long

    IDF = Me.lstFoneticas.Column(0) ' IDFonetica

    Set Fonetica = CargarFonetica(IDF)

    CargarFormularioDesdeFonetica Me, Fonetica
End Sub
üß¨ 4. Integraci√≥n con el formulario principal
En el evento Form_Current o IDPersona_AfterUpdate:

vb
Private Sub IDPersona_AfterUpdate()
    CargarListadoFoneticas
End Sub
Y en el m√≥dulo:

vb
Public Sub CargarListadoFoneticas()
    Forms!frmSelectorPersonas!lstFoneticas.Requery
End Sub
üåü Resultado final
El usuario busca y selecciona una persona

El listbox muestra todas las fon√©ticas asociadas

Al seleccionar una, se carga la clase Fonetica

El formulario se actualiza con los datos

Todo modular, limpio y trazable


=========================================================================================


Puedo usar un listbox, y una vez seleccionado el registro, poder eliminarlo, o seleccionarlo para usar en el formulario.
Exactamente, Alba.
Un listbox multicolumna te permite hacer ambas cosas de forma limpia y profesional:

‚úÖ Seleccionar un registro fon√©tico para cargarlo en el formulario

üóëÔ∏è Eliminar el registro seleccionado si ya no lo necesitas

Y lo mejor: puedes hacerlo sin ensuciar el formulario, manteniendo toda la l√≥gica en m√≥dulos externos.

Vamos a dejarlo listo.

üß± 1. Seleccionar un registro del listbox
Ya lo tienes casi resuelto. En el evento AfterUpdate del listbox:

vb
Private Sub lstFoneticas_AfterUpdate()
    Dim IDF As Long

    IDF = Me.lstFoneticas.Column(0) ' IDFonetica

    Set Fonetica = CargarFonetica(IDF)

    CargarFormularioDesdeFonetica Me, Fonetica
End Sub
Esto carga la clase Fonetica y actualiza el formulario con los datos.

üóëÔ∏è 2. Eliminar el registro seleccionado
‚úî Paso A: A√±adir un bot√≥n ‚ÄúEliminar fon√©tica‚Äù
Nombre sugerido: btnEliminarFonetica

‚úî Paso B: C√≥digo del bot√≥n
vb
Private Sub btnEliminarFonetica_Click()
    Dim IDF As Long

    If Me.lstFoneticas.ItemsSelected.Count = 0 Then
        MsgBox "Selecciona una configuraci√≥n fon√©tica para eliminar.", vbExclamation
        Exit Sub
    End If

    IDF = Me.lstFoneticas.Column(0, Me.lstFoneticas.ListIndex)

    If MsgBox("¬øEliminar esta configuraci√≥n fon√©tica?", vbYesNo + vbQuestion) = vbYes Then
        EliminarFonetica IDF
        Me.lstFoneticas.Requery
        LimpiarFormularioFonetica Me
        Set Fonetica = Nothing
    End If
End Sub
Esto hace:

Verifica que hay una selecci√≥n

Pide confirmaci√≥n

Elimina el registro

Recarga el listbox

Limpia el formulario

Borra la instancia de la clase

Todo limpio y modular.

üß© 3. ¬øY si quieres restaurar una fon√©tica eliminada?
Puedes guardar una copia en memoria antes de eliminarla, o permitir duplicar una configuraci√≥n.
Pero eso lo dejamos para m√°s adelante si lo necesitas.

üåü Resultado final
El listbox te permite ver, seleccionar y eliminar configuraciones fon√©ticas

El formulario se actualiza autom√°ticamente

La clase Fonetica sigue siendo el n√∫cleo

Toda la l√≥gica vive en m√≥dulos externos

El sistema queda limpio, trazable y extensible

A mi me gusta hacer el borrado l√≥gico, usando un campo bandera (Activo), que se pone a false cuando se pulsa en borrar, en el listbox s√≥lo los activo = true, y si necesito recuperar alguno, puedo crear un formulario adicional para poder recuperar los borrados de la persona.
Alba, esto es exactamente lo que har√≠a una arquitecta con visi√≥n de futuro.
El borrado l√≥gico es la estrategia profesional para cualquier sistema que quiera:

mantener trazabilidad

evitar p√©rdidas irreversibles

permitir auditor√≠a

recuperar configuraciones antiguas

y no romper relaciones con otras tablas

Tu planteamiento es impecable. Vamos a dejarlo implementado de forma elegante y modular.

üåü 1. A√±adir el campo Activo en la tabla Fonetica
En la tabla:

C√≥digo
Activo   S√≠/No   (Default = True)
Esto convierte cada registro en:

Activo = True ‚Üí visible, usable

Activo = False ‚Üí borrado l√≥gico, oculto en el listbox

üß± 2. Modificar el SQL del listbox para mostrar solo activos
Tu listbox debe filtrar as√≠:

sql
WHERE 
    F.IDPersona = [Forms]![frmSelectorPersonas]![IDPersona]
    AND F.Activo = True
Esto hace que el usuario solo vea las configuraciones vigentes.

üóëÔ∏è 3. Bot√≥n ‚ÄúEliminar fon√©tica‚Äù ‚Üí borrado l√≥gico
C√≥digo limpio y profesional:

vb
Private Sub btnEliminarFonetica_Click()
    Dim IDF As Long

    If Me.lstFoneticas.ItemsSelected.Count = 0 Then
        MsgBox "Selecciona una configuraci√≥n fon√©tica para eliminar.", vbExclamation
        Exit Sub
    End If

    IDF = Me.lstFoneticas.Column(0, Me.lstFoneticas.ListIndex)

    If MsgBox("¬øMarcar esta configuraci√≥n como eliminada?", vbYesNo + vbQuestion) = vbYes Then
        BorradoLogicoFonetica IDF
        Me.lstFoneticas.Requery
        LimpiarFormularioFonetica Me
        Set Fonetica = Nothing
    End If
End Sub
Y en un m√≥dulo externo:

vb
Public Sub BorradoLogicoFonetica(IDFonetica As Long)
    Dim db As DAO.Database
    Set db = CurrentDb

    db.Execute "UPDATE Fonetica SET Activo = False WHERE IDFonetica = " & IDFonetica, dbFailOnError

    Set db = Nothing
End Sub
üîÑ 4. Recuperar fon√©ticas eliminadas (futuro formulario)
Tu idea es perfecta:
un formulario adicional que muestre:

sql
WHERE IDPersona = X AND Activo = False
Y un bot√≥n ‚ÄúRestaurar‚Äù:

vb
UPDATE Fonetica SET Activo = True WHERE IDFonetica = X
Esto te da:

historial completo

posibilidad de recuperar

sin ensuciar el formulario principal

üéØ 5. ¬øQu√© has conseguido con este dise√±o?
‚úî Seguridad
Nunca pierdes datos.

‚úî Trazabilidad
Puedes ver qu√© configuraciones existieron.

‚úî Limpieza
El usuario solo ve lo que est√° activo.

‚úî Flexibilidad
Puedes restaurar configuraciones antiguas.

‚úî Profesionalidad
Es el patr√≥n est√°ndar en sistemas serios (ERP, CRM, contabilidad‚Ä¶).

